
<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <url-group>
    <name>sns-access-group</name>
    <url>http://example.com</url> <!-- Placeholder for Social Networking Services -->
  </url-group>
  <user-group>
    <name>sns-users</name>
    <range-ipv4-address>
      <start>192.0.2.1</start> <!-- Placeholder IP range -->
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Block_SNS_Access_During_Business_Hours</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Block_Access_During_Business_Hours</name>
    <condition>
      <firewall>
        <source>sns-users</source>
      </firewall>
      <url-category>
        <url-name>sns-access-group</url-name>
      </url-category>
      <context>
        <time>
          <period>
            <start-time>08:00:00Z</start-time>
            <end-time>18:00:00Z</end-time>
            <day>monday</day>
            <day>tuesday</day>
            <day>wednesday</day>
            <day>thursday</day>
            <day>friday</day>
          </period>
          <frequency>weekly</frequency>
        </time>
      </context>
    </condition>
    <action>
      <primary-action>
        <action>drop</action> <!-- Blocking access -->
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <voice-group>
    <name>VoIP_VoCN_Services</name>
    <sip-id>sip:2030@company.com</sip-id>
    <sip-id>sip:2031@company.com</sip-id>
  </voice-group>
</endpoint-groups>
<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <threat-feed-list>
    <name>malicious_voip_packets</name>
    <ioc>malicious.voip.packet.example</ioc>
    <ioc>hash:malicious_packet_hash12345</ioc>
    <format>stix</format>
  </threat-feed-list>
</threat-prevention>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Block_Malicious_VoIP_Packets</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Block_Malicious_VoIP_or_VoCN_Packets</name>
    <condition>
      <firewall>
        <source>VoIP_VoCN_Services</source>
        <destination>company_network</destination>
      </firewall>
      <context>
        <time>
          <start-date-time>2025-01-01T00:00:00Z</start-date-time>
          <end-date-time>2025-12-31T23:59:59Z</end-date-time>
        </time>
      </context>
    </condition>
    <action>
      <primary-action>
        <action>drop</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>company-web-server</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.254</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Mitigate_Flood_Attacks_Policy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Flood_Attack_Prevention_Rule</name>
    <condition>
      <firewall>
        <source>company-web-server</source>
        <destination>company-web-server</destination>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>rate-limit</action>
        <limit>1000</limit>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>sons_computers</name>
    <mac-address>00:00:00:00:00:01</mac-address>
    <ipv4-prefix>192.0.2.0/24</ipv4-prefix>
  </user-group>
</endpoint-groups>
<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <threat-feed-list>
    <name>malicious-websites-feed</name>
    <ioc>http://malicious.site</ioc>
    <ioc>http://suspicious.site</ioc>
    <format>stix</format>
  </threat-feed-list>
</threat-prevention>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Block_Sons_Computers_From_Malicious_Websites</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Block_Access_To_Malicious_Websites</name>
    <condition>
      <firewall>
        <source>sons_computers</source>
        <destination>
          <url-category>
            <url-name>malicious-websites-feed</url-name>
          </url-category>
        </destination>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>drop</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <url-group>
        <name>SNS Endpoint Group</name>
        <url>https://example.com</url> <!-- Placeholder for SNS blocking -->
    </url-group>
    <user-group>
        <name>Employees</name>
        <range-ipv4-address>
            <start>192.0.2.1</start>
            <end>192.0.2.50</end>
        </range-ipv4-address>
    </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <!-- No specific threat feeds mentioned, leaving this empty -->
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <name>Block_SNS_Access_During_Office_Hours</name>
    <language>en-US</language>
    <priority-usage>priority-by-order</priority-usage>
    <resolution-strategy>fmr</resolution-strategy>
    <rules>
        <name>Block_SNS_Access_Office_Hours</name>
        <condition>
            <firewall>
                <source>Employees</source>
            </firewall>
            <url-category>
                <url-name>SNS Endpoint Group</url-name>
            </url-category>
            <context>
                <time>
                    <start-date-time>2025-09-01T09:00:00Z</start-date-time>
                    <end-date-time>2025-09-01T17:00:00Z</end-date-time>
                    <period>
                        <start-time>09:00:00Z</start-time>
                        <end-time>17:00:00Z</end-time>
                        <day>monday</day>
                        <day>tuesday</day>
                        <day>wednesday</day>
                        <day>thursday</day>
                        <day>friday</day>
                    </period>
                    <frequency>weekly</frequency>
                </time>
            </context>
        </condition>
        <action>
            <primary-action>
                <action>drop</action> <!-- Blocking SNS access -->
            </primary-action>
        </action>
    </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <user-group>
        <name>User Devices</name>
        <range-ipv4-address>
            <start>192.0.2.1</start>
            <end>192.0.2.50</end>
        </range-ipv4-address>
    </user-group>
    <url-group>
        <name>youtube</name>
        <url>https://www.youtube.com</url>
    </url-group>
</endpoint-groups>
<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <threat-feed-list>
        <name>generic-url-blocklist</name>
        <ioc>youtube.com</ioc>
        <format>stix</format>
    </threat-feed-list>
</threat-prevention>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <name>Block_YouTube_Access</name>
    <language>en-US</language>
    <priority-usage>priority-by-order</priority-usage>
    <resolution-strategy>fmr</resolution-strategy>
    <rules>
        <name>Block_Access_If_Requested</name>
        <condition>
            <firewall>
                <source>User Devices</source>
                <destination>youtube</destination>
            </firewall>
        </condition>
        <action>
            <primary-action>
                <action>drop</action>
            </primary-action>
        </action>
    </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <endpoint-groups>
        <device-group>
            <name>all-devices</name>
            <range-ipv4-address>
                <start>192.0.2.0</start>
                <end>192.0.2.255</end>
            </range-ipv4-address>
        </device-group>
    </endpoint-groups>
    <threat-prevention>
        <threat-feed-list>
            <name>adult-content-filters</name>
            <ioc>adult-site-filter-1</ioc>
            <ioc>adult-site-filter-2</ioc>
            <format>stix</format>
        </threat-feed-list>
    </threat-prevention>
    <i2nsf-cfi-policy>
        <name>Restrict_Adult_Content_Access</name>
        <rules>
            <name>Restrict_Access_From_Any_Device</name>
            <condition>
                <firewall>
                    <source>all-devices</source>
                </firewall>
                <url-category>
                    <url-name>adult-content-filters</url-name>
                </url-category>
            </condition>
            <action>
                <primary-action>
                    <action>drop</action>
                </primary-action>
            </action>
        </rules>
    </i2nsf-cfi-policy>
</policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>All Gaming Devices</name>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Block_Weekday_Night_Games</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Block_All_Games_On_Weekday_Nights</name>
    <condition>
      <firewall>
        <source>All Gaming Devices</source>
      </firewall>
      <context>
        <time>
          <period>
            <start-time>19:00:00Z</start-time> <!-- Start of night -->
            <end-time>23:59:59Z</end-time>   <!-- End of night -->
            <day>monday</day>
            <day>tuesday</day>
            <day>wednesday</day>
            <day>thursday</day>
            <day>friday</day>
          </period>
          <frequency>weekly</frequency>
        </time>
      </context>
    </condition>
    <action>
      <primary-action>
        <action>drop</action> <!-- Specifies to block all games -->
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group name="internal-HR-system">
    <mac-address>00:00:00:00:00:00</mac-address>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>
<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
</threat-prevention>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Allow_Internal_HR_Traffic</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Allow_HR_Traffic</name>
    <condition>
      <firewall>
        <source>internal-HR-system</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>pass</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>employees</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Web_Browsing_Policy</name>
  <rules>
    <name>Permit_Employees_Web_Browsing</name>
    <condition>
      <firewall>
        <source>employees</source>
        <destination>web</destination>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>pass</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <endpoint-groups>
    <device-group>
      <name>trusted-devices</name>
      <range-ipv4-address>
        <start>192.0.2.1</start>
        <end>192.0.2.50</end>
      </range-ipv4-address>
    </device-group>
  </endpoint-groups>
  <threat-prevention />
  <i2nsf-cfi-policy>
    <name>Allow_Trusted_Device_Traffic</name>
    <rules>
      <name>Allow_Without_Filtering</name>
      <condition>
        <firewall>
          <source>trusted-devices</source>
        </firewall>
      </condition>
      <action>
        <primary-action>
          <action>pass</action>
        </primary-action>
      </action>
    </rules>
  </i2nsf-cfi-policy>
</policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>malicious_ip_endpoints</name>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>
<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <threat-feed-list>
    <name>malicious_ip_feed</name>
    <ioc>malicious.example.com</ioc>
    <format>stix</format>
  </threat-feed-list>
</threat-prevention>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Malicious_IP_Traffic_Drop_Policy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Drop_Known_Malicious_IPs</name>
    <condition>
      <firewall>
        <source>malicious_ip_endpoints</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>drop</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <endpoint-groups>
        <user-group>
            <name>guest-network</name>
            <range-ipv4-address>
                <start>192.0.2.1</start>
                <end>192.0.2.254</end>
            </range-ipv4-address>
        </user-group>
    </endpoint-groups>
    <i2nsf-cfi-policy>
        <name>Block_Guest_Network_Incoming_Connections</name>
        <rules>
            <name>Block_Incoming_Connections_From_Guest_Network</name>
            <condition>
                <firewall>
                    <source>guest-network</source>
                </firewall>
            </condition>
            <action>
                <primary-action>
                    <action>drop</action>
                </primary-action>
            </action>
        </rules>
    </i2nsf-cfi-policy>
</policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>Unknown Traffic Group</name>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <threat-feed-list>
      <name>generic-threat-feed</name>
      <ioc>unknown-or-unclassified</ioc>
      <format>stix</format>
  </threat-feed-list>
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Discard_Unknown_Traffic</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Discard_Unknown_or_Unclassified</name>
    <condition>
      <firewall>
        <source>Unknown Traffic Group</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>drop</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>Unauthorized_Login_Endpoints</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <threat-feed-list>
    <name>no-threat-feed</name>
    <ioc></ioc>
    <format>stix</format>
  </threat-feed-list>
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Unauthorized_Login_Protection</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Reject_Unauthorized_Login</name>
    <condition>
      <firewall>
        <source>Unauthorized_Login_Endpoints</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>reject</action>
      </primary-action>
      <secondary-action>
        <log-action>send-error-notification</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>Disallowed Ports Group</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>
<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <threat-feed-list>
    <name>disallowed-ports-threat</name>
    <ioc>no-threats-available</ioc>
    <format>stix</format>
  </threat-feed-list>
</threat-prevention>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Actively_Refuse_Traffic_On_Disallowed_Ports</name>
  <rules>
    <name>Refuse_Disallowed_Ports</name>
    <condition>
      <firewall>
        <source>Disallowed Ports Group</source>
      </firewall>
      <range-port-number>
        <start>1</start>
        <end>65535</end>
      </range-port-number>
    </condition>
    <action>
      <primary-action>
        <action>drop</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>database-servers</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </device-group>
  <device-group>
    <name>analysis-server</name>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <threat-feed-list>
    <name>suspicious-database-traffic-feed</name>
    <ioc>hash:abcd1234</ioc>
    <ioc>malicious.example</ioc>
    <format>stix</format>
  </threat-feed-list>
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Mirror_Suspicious_Database_Traffic</name>
  <rules>
    <name>Mirror_Traffic_if_Suspicious</name>
    <condition>
      <firewall>
        <source>database-servers</source>
        <destination>analysis-server</destination>
      </firewall>
      <context>
        <time>
          <start-date-time>2023-01-01T00:00:00Z</start-date-time>
          <end-date-time>2025-12-31T23:59:59Z</end-date-time>
        </time>
      </context>
    </condition>
    <action>
      <primary-action>
        <action>mirror</action>
      </primary-action>
      <primary-action>
        <action>pass</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>outgoing-email-servers</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Outgoing_Email_Traffic_Monitoring_Policy</name>
  <rules>
    <name>Copy_Outgoing_Email_Traffic</name>
    <condition>
      <firewall>
        <source>outgoing-email-servers</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>mirror</action>
      </primary-action>
      <primary-action>
        <action>forwarding</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>iot-devices</name>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <!-- No threat feeds defined in the provided policy intent. -->
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>IoT_Traffic_Forwarding_Policy</name>
  <rules>
    <name>Forward_IoT_Traffic_To_Specialized_Gateway</name>
    <condition>
      <firewall>
        <source>iot-devices</source>
        <destination>specialized-gateway</destination>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>forwarding</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <endpoint-groups>
    <url-group>
      <name>video-streaming-traffic</name>
      <range-ipv4-address>
        <start>192.0.2.0</start>
        <end>192.0.2.255</end>
      </range-ipv4-address>
    </url-group>
  </endpoint-groups>
  <threat-prevention>
    <!-- No threat feeds are mentioned in the policy intent -->
  </threat-prevention>
  <i2nsf-cfi-policy>
    <name>Video_Streaming_Proxy_Routing</name>
    <language>en-US</language>
    <priority-usage>priority-by-order</priority-usage>
    <resolution-strategy>fmr</resolution-strategy>
    <rules>
      <name>Route_Video_Streaming_Through_Proxy</name>
      <condition>
        <firewall>
          <source>video-streaming-traffic</source>
          <destination>proxy-server-in-dmz</destination>
        </firewall>
      </condition>
      <action>
        <primary-action>
          <action>forwarding</action>
        </primary-action>
      </action>
    </rules>
  </i2nsf-cfi-policy>
</policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <device-group>
        <name>iot-sensors</name>
        <range-ipv4-address>
            <start>192.0.2.0</start>
            <end>192.0.2.255</end>
        </range-ipv4-address>
    </device-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <!-- No specific threat feed was provided thus leaving it empty -->
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <name>IoT_HTTP_to_CoAP_Translation_Policy</name>
    <language>en-US</language>
    <priority-usage>priority-by-order</priority-usage>
    <resolution-strategy>fmr</resolution-strategy>
    <rules>
        <name>Incoming_HTTP_Request_Translation</name>
        <condition>
            <firewall>
                <source>iot-sensors</source>
            </firewall>
        </condition>
        <action>
            <primary-action>
                <action>pass</action> <!-- Assuming we need to pass the translated request -->
            </primary-action>
        </action>
    </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>Financial_Data_Endpoints</name>
    <ipv4-prefix>192.0.2.0/24</ipv4-prefix>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <!-- No specific threat feeds were defined for this policy. -->
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Secure_Financial_Data_Traffic_Policy</name>
  <rules>
    <name>Encapsulate_Sensitive_Data</name>
    <condition>
      <firewall>
        <source>Financial_Data_Endpoints</source>
        <destination>central-server-endpoint</destination>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>tunnel-encapsulation</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>detected-port-scanners</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <threat-feed-list>
    <name>port-scan-alerts</name>
    <ioc>some-campaign-identifier-for-port-scan</ioc>
    <format>stix</format>
  </threat-feed-list>
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>port_scan_alert_policy</name>
  <rules>
    <name>send_alert_on_port_scan</name>
    <condition>
      <firewall>
        <source>detected-port-scanners</source>
        <destination>detected-port-scanners</destination>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>invoke-signaling</action>
      </primary-action>
      <secondary-action>
        <log-action>rule-log</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>Streaming_Media_Endpoints</name>
    <range-ipv4-address>
      <start>203.0.113.1</start>
      <end>203.0.113.50</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface"/>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Streaming_Media_Throttle_Policy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Throttle_Streaming_Traffic_Threshold</name>
    <condition>
      <firewall>
        <source>Streaming_Media_Endpoints</source>
      </firewall>
      <ddos>
        <rate-limit>
          <byte-rate-threshold>100000000</byte-rate-threshold> <!-- 100 MB/s in bytes -->
        </rate-limit>
      </ddos>
    </condition>
    <action>
      <primary-action>
        <action>rate-limit</action>
        <limit>100000000</limit> <!-- Limit set to 100 MB/s -->
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>guest-network-devices</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Guest_Network_Bandwidth_Limitation</name>
  <rules>
    <name>Limit_Guest_Network_Bandwidth</name>
    <condition>
      <firewall>
        <source>guest-network-devices</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>rate-limit</action>
        <limit>1000</limit>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>server-endpoints</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <threat-feed-list>
    <name>generic-threat-feed</name>
    <ioc>threat.example.com</ioc>
    <ioc>hash:examplehash1234</ioc>
    <format>stix</format>
  </threat-feed-list>
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>ConnectionFlowLimitPolicy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>CapNewConnectionAttempts</name>
    <condition>
      <ddos>
        <rate-limit>
          <flow-rate-threshold>20</flow-rate-threshold>
        </rate-limit>
      </ddos>
      <firewall>
        <source>server-endpoints</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>rate-limit</action>
        <limit>20</limit>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>ICMP_traffic_endpoints</name>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>ICMP_Rate_Limiting_Policy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Apply_500_pps_Rate_Limit</name>
    <condition>
      <firewall>
        <source>ICMP_traffic_endpoints</source>
      </firewall>
      <ddos>
        <rate-limit>
          <packet-rate-threshold>500</packet-rate-threshold>
        </rate-limit>
      </ddos>
    </condition>
    <action>
      <primary-action>
        <action>rate-limit</action>
        <limit>500</limit>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <endpoint-groups>
    <device-group>
      <name>backup_data_servers</name>
      <range-ipv4-address>
        <start>192.0.2.1</start>
        <end>192.0.2.50</end>
      </range-ipv4-address>
    </device-group>
  </endpoint-groups>
  <threat-prevention>
    <threat-feed-list>
      <name>generic-threat-feed</name>
      <ioc>malicious.com</ioc>
      <ioc>hash:abcd1234</ioc>
      <format>stix</format>
    </threat-feed-list>
  </threat-prevention>
  <i2nsf-cfi-policy>
    <name>Backup_Data_Transfer_Restriction</name>
    <language>en-US</language>
    <priority-usage>priority-by-order</priority-usage>
    <resolution-strategy>fmr</resolution-strategy>
    <rules>
      <name>Limit_Backup_Transfer_Speed_Work_Hours</name>
      <condition>
        <firewall>
          <source>backup_data_servers</source>
        </firewall>
        <context>
          <time>
            <period>
              <start-time>08:00:00Z</start-time>
              <end-time>18:00:00Z</end-time>
              <day>monday</day>
              <day>tuesday</day>
              <day>wednesday</day>
              <day>thursday</day>
              <day>friday</day>
            </period>
            <frequency>daily</frequency>
          </time>
        </context>
      </condition>
      <action>
        <primary-action>
          <action>rate-limit</action>
          <limit>10</limit>
        </primary-action>
      </action>
    </rules>
  </i2nsf-cfi-policy>
</policy>



<?xml version="1.0" encoding="UTF-8"?>
<policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <endpoint-groups>
    <user-group>
      <name>admin-ports</name>
      <ipv4-prefix>192.0.2.0/24</ipv4-prefix>
    </user-group>
  </endpoint-groups>
  <threat-prevention>
    <!-- No specific threat feeds are referenced in the original intent -->
  </threat-prevention>
  <i2nsf-cfi-policy>
    <name>Block_Admin_Port_Traffic</name>
    <language>en-US</language>
    <priority-usage>priority-by-order</priority-usage>
    <resolution-strategy>fmr</resolution-strategy>
    <rules>
      <name>Block_Traffic_And_Log_Attempt</name>
      <condition>
        <firewall>
          <destination>admin-ports</destination>
        </firewall>
      </condition>
      <action>
        <primary-action>
          <action>drop</action>
        </primary-action>
        <secondary-action>
          <log-action>rule-log</log-action>
        </secondary-action>
      </action>
    </rules>
  </i2nsf-cfi-policy>
</policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>File_Downloading_Devices</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
	<!-- No specific threat feeds provided, thus not included. -->
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Allow_File_Downloads_With_Logging</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Generate_Log_On_File_Download</name>
    <condition>
      <firewall>
        <source>File_Downloading_Devices</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>pass</action>
      </primary-action>
      <secondary-action>
        <log-action>rule-log</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <user-group name="User_Login_Endpoints">
        <name>User_Login_Endpoints</name>
        <range-ipv4-address>
            <start>192.0.2.1</start>
            <end>192.0.2.50</end>
        </range-ipv4-address>
    </user-group>
</endpoint-groups>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <name>Monitor_Login_Attempts_Policy</name>
    <language>en-US</language>
    <priority-usage>priority-by-order</priority-usage>
    <resolution-strategy>fmr</resolution-strategy>
    <rules>
        <name>Permit_And_Log_Login_Attempts</name>
        <condition>
            <firewall>
                <source>User_Login_Endpoints</source>
                <destination>unknown-destination</destination>
            </firewall>
            <context>
                <time>
                    <start-date-time>2023-10-01T00:00:00Z</start-date-time>
                    <end-date-time>2023-10-31T23:59:59Z</end-date-time>
                    <frequency>daily</frequency>
                </time>
            </context>
        </condition>
        <action>
            <primary-action>
                <action>pass</action>
            </primary-action>
            <secondary-action>
                <log-action>rule-log</log-action>
            </secondary-action>
        </action>
    </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>Database Servers</name>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <!-- No specific threat feeds are referenced, hence empty. Could be populated if future data is provided. -->
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Permit_Database_Access_And_Log_Session_Details</name>
  <rules>
    <name>Allow_And_Log_DB_Connection</name>
    <condition>
      <firewall>
        <source>Database Servers</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>pass</action>
      </primary-action>
      <secondary-action>
        <log-action>session-log</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>

<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>vpn-endpoints</name>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <!-- No threat feeds defined in the policy -->
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Allow_VPN_Connections_And_Session_Logging</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Log_VPN_Session</name>
    <condition>
      <firewall>
        <source>vpn-endpoints</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>invoke-signaling</action>
      </primary-action>
      <secondary-action>
        <log-action>session-log</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>employees</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.254</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface" />

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Employee_Web_Browsing_Policy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  
  <rules>
    <name>Log_Web_Browsing_Activity</name>
    <action>
      <primary-action>
        <action>pass</action>
      </primary-action>
      <secondary-action>
        <log-action>rule-log</log-action>
      </secondary-action>
    </action>
    <condition>
      <firewall>
        <source>employees</source>
      </firewall>
    </condition>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group name="guest-network">
    <name>guest-network</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.254</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Block_Guest_Network_SSH_Access</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Drop_SSH_Guest_Network_Connections</name>
    <condition>
      <firewall>
        <source>guest-network</source>
        <range-port-number>
          <start>22</start>
          <end>22</end>
        </range-port-number>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>drop</action>
      </primary-action>
      <secondary-action>
        <log-action>rule-log</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>finance-department</name>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Permit_Finance_Department_DB_Traffic</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Allow_Finance_DB_Traffic_And_Log</name>
    <condition>
      <firewall>
        <source>finance-department</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>pass</action>
      </primary-action>
      <secondary-action>
        <log-action>session-log</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>

<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>Unauthorized_VPN_Login_Attempts</name>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <!-- No specific threat feeds mentioned in the intent -->
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Reject_Unauthorized_VPN_Login_Attempts</name>
  <rules>
    <name>Unauthorized_VPN_Login_Reject</name>
    <condition>
      <firewall>
        <source>Unauthorized_VPN_Login_Attempts</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>reject</action>
      </primary-action>
      <secondary-action>
        <log-action>session-log</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>External Clients</name>
    <ipv4-prefix>192.0.2.0/24</ipv4-prefix>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>External_Web_Server_Access_Policy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Allow_External_Client_Access_Logging</name>
    <condition>
      <firewall>
        <source>External Clients</source>
        <destination>Web Server</destination>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>pass</action>
      </primary-action>
      <secondary-action>
        <log-action>session-log</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>employees</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </user-group>
  <device-group>
    <name>finance_servers</name>
    <range-ipv4-address>
      <start>192.0.2.0</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Employee_Access_Control_Policy</name>
  <rules>
    <name>Disciplinary_Action_For_Unauthorized_Access</name>
    <condition>
      <firewall>
        <source>employees</source>
        <destination>finance_servers</destination>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>drop</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>firewall-managed-endpoints</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Firewall_Configuration_Change_Policy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Security_Protocol_Compliance_After_Change</name>
    <condition>
      <firewall>
        <source>firewall-managed-endpoints</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>invoke-signaling</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>unauthorized-dns-modifiers</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>DNS_Alteration_Protection_Policy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Unauthorized_DNS_Alteration_Detection</name>
    <condition>
      <firewall>
        <source>unauthorized-dns-modifiers</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>reject</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <device-group>
        <name>database-servers</name>
        <range-ipv4-address>
            <start>192.0.2.1</start>
            <end>192.0.2.50</end>
        </range-ipv4-address>
    </device-group>
</endpoint-groups>
<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <!-- No threat feeds defined for this policy -->
</threat-prevention>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
    <name>DatabaseMemoryManagementPolicy</name>
    <language>en-US</language>
    <priority-usage>priority-by-order</priority-usage>
    <resolution-strategy>fmr</resolution-strategy>
    <rules>
        <name>InitiateMemoryOptimization</name>
        <condition>
            <firewall>
                <destination>database-servers</destination>
            </firewall>
        </condition>
        <action>
            <primary-action>
                <action>invoke-signaling</action>
            </primary-action>
        </action>
    </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>Firewall_Management_Group</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>
<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <threat-feed-list>
    <name>generic-performance-monitoring-threats</name>
    <ioc>cpu-load-exceeding-90</ioc>
    <format>stix</format>
  </threat-feed-list>
</threat-prevention>
<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>CPU_Load_Management_Policy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>High_CPU_Load_Alert</name>
    <condition>
      <firewall>
        <source>Firewall_Management_Group</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>invoke-signaling</action>
      </primary-action>
      <secondary-action>
        <log-action>session-log</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>Core_Network_Interfaces</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.254</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Core_Network_Interface_Failover_Policy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Core_Interface_Down_Notification_Procedure</name>
    <condition>
      <firewall>
        <source>Core_Network_Interfaces</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>invoke-signaling</action>
      </primary-action>
      <secondary-action>
        <log-action>rule-log</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>System_Performance_Management_Endpoints</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.50</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>CPU_Overload_Management_Policy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Manage_CPU_Overload_Actions</name>
    <condition>
      <firewall>
        <source>System_Performance_Management_Endpoints</source>
        <destination>System_Performance_Management_Endpoints</destination>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>drop</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <device-group>
    <name>firewall-devices</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.255</end>
    </range-ipv4-address>
  </device-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <!-- Currently, no specific threat feeds are mentioned, so this is left empty -->
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>FirewallMemoryUsagePolicy</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>ConfigurationChangeDuringHighMemoryUsage</name>
    <condition>
      <firewall>
        <source>firewall-devices</source>
      </firewall>
    </condition>
    <action>
      <primary-action>
        <action>drop</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <user-group>
    <name>compromised-endpoints</name>
    <range-ipv4-address>
      <start>192.0.2.1</start>
      <end>192.0.2.254</end>
    </range-ipv4-address>
  </user-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
	<threat-feed-list>
		<name>zeus-ioc</name>
		<ioc>hash:abcd1234</ioc>
		<ioc>hash:abcd5678</ioc>
		<format>stix</format>
	</threat-feed-list>
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Zeus_IOC_Traffic_Management</name>
  <language>en-US</language>
  <priority-usage>priority-by-order</priority-usage>
  <resolution-strategy>fmr</resolution-strategy>
  <rules>
    <name>Drop_Log_Block_IOCs</name>
    <condition>
      <firewall>
        <source>compromised-endpoints</source>
      </firewall>
      <threat-feed>
        <name>zeus-ioc</name>
      </threat-feed>
    </condition>
    <action>
      <primary-action>
        <action>drop</action>
      </primary-action>
      <secondary-action>
        <log-action>rule-log</log-action>
      </secondary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



<?xml version="1.0" encoding="UTF-8"?>
<policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <endpoint-groups>
    <user-group>
      <name>Ransomware Protection Endpoints</name>
      <range-ipv4-address>
        <start>192.0.2.1</start>
        <end>192.0.2.50</end>
      </range-ipv4-address>
    </user-group>
  </endpoint-groups>
  
  <threat-prevention>
    <threat-feed-list>
      <name>Ransomware Threat Feed</name>
      <ioc>sample-ioc-1</ioc>
      <ioc>sample-ioc-2</ioc>
      <format>stix</format>
    </threat-feed-list>
  </threat-prevention>
  
  <i2nsf-cfi-policy>
    <name>Anti-Virus_Ransomware_Detection_Policy</name>
    <language>en-US</language>
    <priority-usage>priority-by-order</priority-usage>
    <resolution-strategy>fmr</resolution-strategy>
    <rules>
      <name>Investigate_or_Block_File_Transfer</name>
      <condition>
        <anti-virus>
          <profile>Ransomware Detection Profile</profile>
        </anti-virus>
        <firewall>
          <source>Ransomware Protection Endpoints</source>
        </firewall>
      </condition>
      <action>
        <primary-action>
          <action>drop</action>
        </primary-action>
      </action>
    </rules>
  </i2nsf-cfi-policy>
</policy>



<?xml version="1.0" encoding="UTF-8"?>
<policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <endpoint-groups>
    <device-group>
      <name>Maintenance_Servers</name>
      <range-ipv4-address>
        <start>192.0.2.1</start>
        <end>192.0.2.254</end>
      </range-ipv4-address>
    </device-group>
    <device-group>
      <name>Network_Infrastructure</name>
      <range-ipv4-address>
        <start>192.0.2.1</start>
        <end>192.0.2.254</end>
      </range-ipv4-address>
    </device-group>
  </endpoint-groups>
  <threat-prevention>
  </threat-prevention>
  <i2nsf-cfi-policy>
    <name>Monthly_Maintenance_Policy</name>
    <language>en-US</language>
    <priority-usage>priority-by-order</priority-usage>
    <resolution-strategy>fmr</resolution-strategy>
    <rules>
      <name>First_Sunday_Maintenance_Rule</name>
      <condition>
        <context>
          <time>
            <period>
              <start-time>02:00:00Z</start-time>
              <end-time>04:00:00Z</end-time>
              <day>sunday</day>
              <frequency>monthly</frequency>
            </period>
          </time>
        </context>
      </condition>
      <action>
        <primary-action>
          <action>invoke-signaling</action>
        </primary-action>
      </action>
    </rules>
  </i2nsf-cfi-policy>
</policy>



<?xml version="1.0" encoding="UTF-8"?>
<endpoint-groups xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <voice-group>
    <name>blacklist_sip</name>
    <sip-id>sip:2001@corp.com</sip-id>
    <sip-id>sip:2002@corp.com</sip-id>
    <sip-id>sip:2003@corp.com</sip-id>
    <sip-id>sip:2004@corp.com</sip-id>
    <sip-id>sip:2005@corp.com</sip-id>
    <sip-id>sip:2006@corp.com</sip-id>
  </voice-group>
  <voice-group>
    <name>analysis_server</name>
    <sip-id>sip:analysis@corp.com</sip-id>
  </voice-group>
</endpoint-groups>

<threat-prevention xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
	<threat-feed-list>
		<name>sip-blacklist-threat-feed</name>
		<ioc>sip:2001@corp.com</ioc>
		<ioc>sip:2002@corp.com</ioc>
		<ioc>sip:2003@corp.com</ioc>
		<format>stix</format>
	</threat-feed-list>
</threat-prevention>

<i2nsf-cfi-policy xmlns="urn:ietf:params:xml:ns:yang:ietf-i2nsf-cons-facing-interface">
  <name>Voice_Group_Blacklist_Call_Rejection</name>
  <rules>
    <name>Reject_SIP_URI_Session</name>
    <condition>
      <voice>
        <source-id>blacklist_sip</source-id>
      </voice>
    </condition>
    <action>
      <primary-action>
        <action>reject</action>
      </primary-action>
      <primary-action>
        <action>mirror</action>
      </primary-action>
    </action>
  </rules>
</i2nsf-cfi-policy>



